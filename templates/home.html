{% extends 'base.html' %}

{% block title %}Nuevo Despacho – Selectum{% endblock %}

{% block content %}
<div class="card">
    <h1>Crear un nuevo despacho</h1>
    <form action="{{ url_for('despachos.procesar') }}" method="post">
        <label for="origen">Origen:</label><br>
        <input type="text" id="origen" name="origen" required><br><br>

        <label for="destino">Destino:</label><br>
        <input type="text" id="destino" name="destino" required><br><br>

        <label for="producto">Producto / Descripción:</label><br>
        <input type="text" id="producto" name="producto" required><br><br>

        <label for="unidades">Unidades:</label><br>
        <input type="number" id="unidades" name="unidades" required><br><br>

        <label for="documento_comercial">Factura / Remisión:</label><br>
        <input type="text" id="documento_comercial" name="documento_comercial" required><br><br>

        <label for="peso">Peso total (kg):</label><br>
        <input type="number" id="peso" name="peso_total" step="0.01" required><br><br>

        <label for="volumen">Volumen total (m³):</label><br>
        <input type="number" id="volumen" name="volumen_total" step="0.01"><br><br>

        <label for="urgente">¿Es urgente?</label><br>
        <select id="urgente" name="urgente" required>
            <option value="No">No</option>
            <option value="Sí">Sí</option>
        </select><br><br>

        <label for="hora_solicitud">Hora de Solicitud:</label><br>
        <input type="time" id="hora_solicitud" name="hora_solicitud" readonly><br><br>

        <button type="submit">Enviar despacho</button>
    </form>
</div>

<script>
    // Establecer hora de solicitud automáticamente (UTC-5 para Bogotá)
    window.addEventListener('load', () => {
        const now = new Date();
        now.setHours(now.getHours() - 5);
        const hh = now.getHours().toString().padStart(2, '0');
        const mm = now.getMinutes().toString().padStart(2, '0');
        document.getElementById('hora_solicitud').value = `${hh}:${mm}`;
    });
</script>
{% endblock %}
